# Отладка CI

Как смотреть логи GitHub Actions и исправлять типовые ошибки.

## Цель

- Найти причину падения workflow (красный крестик на коммите или PR).
- Понять, какой шаг упал и что поменять локально.

## Где смотреть логи

- На GitHub: репозиторий → вкладка **Actions** → выбери нужный workflow run (по коммиту или ветке).
- Открой job (например **check**) — слева список шагов. Упавший шаг отмечен красным; клик по нему раскрывает лог.

## Типовые ошибки

### Скрипт не найден

**Сообщение:** `python: can't open file 'scripts/...'` или `No such file or directory`.

**Причина:** файл не закоммичен или путь в ci.yml опечатка.

**Решение:** проверь, что файл есть в репо и путь в `.github/workflows/ci.yml` совпадает (например `python scripts/check_links.py`).

### Ошибка в скрипте (exit code 1)

**Сообщение:** в логе шага виден traceback или «Ошибка: …» из скрипта.

**Причина:** скрипт проверки не прошёл (битая ссылка, нарушена гигиена Markdown, пропущен ID в PROGRESS и т.д.).

**Решение:** прочитай последние строки лога — скрипт пишет, что не так. Исправь локально, закоммить, запушь.

### Python version / модуль не найден

**Сообщение:** `ModuleNotFoundError` или несовместимая версия Python.

**Причина:** в CI используется только stdlib; если скрипт тянет внешний пакет — его нет в образе.

**Решение:** перепиши скрипт на stdlib или добавь шаг `pip install` в ci.yml (для этого репо предпочтительно только stdlib).

### Таймаут

**Сообщение:** job cancelled или timeout.

**Причина:** шаг выполняется слишком долго (редко для наших скриптов).

**Решение:** упрости скрипт или разбей проверки на отдельные jobs.

## Локальная проверка перед push

Запусти те же команды, что и в CI:

```bash
python scripts/check_links.py
python scripts/validate_repo.py
python scripts/check_markdown_hygiene.py
python scripts/validate_progress_ids.py
python scripts/validate_docs_index.py
```

Если всё зелёное локально, но CI падает — проверь, что закоммичены все изменённые файлы и что на GitHub актуальный код (git push выполнен).

## Проверка

- После исправления: новый коммит и push; в Actions появится новый run. Успешный run — зелёная галочка.
